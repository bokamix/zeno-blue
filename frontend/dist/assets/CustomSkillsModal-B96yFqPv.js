import{r as d,o as R,e as a,i as n,l as t,L as g,u as y,A as l,p as u,B as w,C,F as j,j as E,D as P,K as X}from"./vue-core-Chol9MOc.js";import{S as q,X as G,P as J,T as O,u as Q}from"./index-C1X3nxtu.js";import{K as W}from"./key-round-Ca6JOrnI.js";import"./tiptap-zBojtxx-.js";import"./markdown-B3lvOPUD.js";import"./highlight-BX1zPj8W.js";const Y={class:"glass-solid rounded-3xl w-full max-w-lg max-h-[80vh] flex flex-col animate-modal-enter relative overflow-hidden"},Z={class:"flex items-center justify-between p-6 border-b border-white/5"},I={class:"flex items-center gap-3"},N={class:"p-2 rounded-xl bg-gradient-to-br from-amber-500/20 to-orange-500/20"},ee={class:"text-lg font-semibold text-[var(--text-primary)]"},te={class:"flex items-center gap-2"},se={class:"flex-1 overflow-y-auto p-6 custom-scroll"},oe={key:0,class:"space-y-4"},le={class:"text-xs text-zinc-500 mb-1 block"},ae=["placeholder"],ne={class:"text-xs text-zinc-500 mb-1 block"},ie=["placeholder"],re={class:"text-xs text-zinc-500 mb-1 block"},de=["placeholder"],ce={key:0,class:"text-xs text-red-400"},ue={class:"flex items-center gap-2 justify-end"},me=["disabled"],ve={key:1},pe={key:0,class:"text-center py-12"},be={class:"text-zinc-400"},xe={key:1,class:"text-center py-12"},he={class:"w-16 h-16 rounded-2xl bg-gradient-to-br from-amber-500/10 to-orange-500/10 flex items-center justify-center mx-auto mb-4"},fe={class:"text-zinc-400 mb-2"},ge={class:"text-xs text-zinc-500"},ye={key:2,class:"space-y-3"},_e={class:"flex items-start justify-between"},ke={class:"flex-1 min-w-0"},$e={class:"text-sm font-medium text-[var(--text-primary)] truncate"},Se={key:0,class:"text-xs text-zinc-500 mt-0.5 line-clamp-2"},we={class:"flex items-center gap-1 flex-shrink-0 ml-3"},Ce=["onClick","title"],ze=["onClick","title"],Fe={key:1,class:"flex items-center gap-1"},Ve=["onClick"],Ke={key:0,class:"mt-3 pt-3 border-t border-white/5"},je={class:"flex items-center gap-1.5 mb-2"},Ee={class:"text-[10px] font-medium text-zinc-500 uppercase tracking-wider"},Pe={class:"text-[10px] text-zinc-600 mb-2"},qe={class:"space-y-2"},Le={class:"flex-1 min-w-0"},Be={class:"flex items-center gap-2"},De={class:"text-[11px] text-zinc-400 font-mono truncate"},Me={key:0,class:"text-[9px] px-1.5 py-0.5 rounded-full bg-emerald-500/15 text-emerald-400 font-medium"},Ue={key:1,class:"text-[9px] px-1.5 py-0.5 rounded-full bg-amber-500/15 text-amber-400 font-medium"},Te={class:"flex items-center gap-1.5 flex-shrink-0"},Ae=["placeholder","onKeydown"],He=["onClick","disabled"],Re=["onClick"],Xe=["onClick"],Ne={__name:"CustomSkillsModal",emits:["close"],setup(Ge,{emit:Je}){const m=Q(),_=d([]),z=d(!0),k=d(!1),v=d(null),$=d(null),h=d(!1),f=d(null),r=d({name:"",description:"",instructions:""}),p=d({}),c=d(null),b=d(""),S=d(!1),F=async()=>{z.value=!0;try{_.value=await m.getCustomSkills();for(const e of _.value)e.required_secrets&&e.required_secrets.length>0&&await L(e.id)}catch(e){console.error("Failed to load custom skills",e)}finally{z.value=!1}},L=async e=>{try{const o=await m.getSkillSecrets(e),s={};for(const i of o)s[i.key]=i.is_set;p.value[e]=s}catch(o){console.error("Failed to load secrets status",o)}},V=(e,o)=>p.value[e]?.[o]||!1,B=(e,o)=>{c.value=`${e}:${o}`,b.value=""},K=async(e,o)=>{if(b.value.trim()){S.value=!0;try{await m.setSkillSecret(e,o,b.value.trim()),p.value[e]||(p.value[e]={}),p.value[e][o]=!0,c.value=null,b.value=""}catch(s){console.error("Failed to save secret",s)}finally{S.value=!1}}},D=async(e,o)=>{try{await m.deleteSkillSecret(e,o),p.value[e]&&(p.value[e][o]=!1)}catch(s){console.error("Failed to remove secret",s)}},M=()=>{f.value=null,r.value={name:"",description:"",instructions:""},v.value=null,h.value=!0},U=e=>{f.value=e.id,r.value={name:e.name,description:e.description||"",instructions:e.instructions||""},v.value=null,h.value=!0},T=()=>{h.value=!1,f.value=null,v.value=null},A=async()=>{if(!(!r.value.name.trim()||!r.value.instructions.trim())){k.value=!0,v.value=null;try{f.value?await m.updateCustomSkill(f.value,r.value):await m.createCustomSkill(r.value),h.value=!1,f.value=null,await F()}catch(e){v.value=e.message}finally{k.value=!1}}},H=async e=>{try{await m.deleteCustomSkill(e),$.value=null,await F()}catch(o){console.error("Failed to delete skill",o)}};return R(()=>{F()}),(e,o)=>(n(),a("div",{class:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:o[8]||(o[8]=X(s=>e.$emit("close"),["self"]))},[t("div",Y,[o[9]||(o[9]=t("div",{class:"absolute top-0 left-8 right-8 h-px bg-gradient-to-r from-transparent via-amber-500/50 to-transparent"},null,-1)),t("div",Z,[t("div",I,[t("div",N,[g(y(q),{class:"w-5 h-5 text-amber-400"})]),t("h2",ee,l(e.$t("modals.customSkills.title")),1)]),t("div",te,[h.value?u("",!0):(n(),a("button",{key:0,onClick:M,class:"px-3 py-1.5 text-xs rounded-lg font-medium transition-all bg-amber-500/20 text-amber-400 hover:bg-amber-500/30"},l(e.$t("modals.customSkills.createSkill")),1)),t("button",{onClick:o[0]||(o[0]=s=>e.$emit("close")),class:"p-2 rounded-xl text-[var(--text-muted)] hover:text-[var(--text-primary)] hover:bg-[var(--bg-surface)] transition-all"},[g(y(G),{class:"w-5 h-5"})])])]),t("div",se,[h.value?(n(),a("div",oe,[t("div",null,[t("label",le,l(e.$t("modals.customSkills.nameLabel")),1),w(t("input",{"onUpdate:modelValue":o[1]||(o[1]=s=>r.value.name=s),type:"text",placeholder:e.$t("modals.customSkills.namePlaceholder"),class:"w-full px-3 py-2 text-sm rounded-lg bg-[var(--bg-elevated)] text-[var(--text-primary)] border border-[var(--border-subtle)] outline-none focus:border-amber-500/50"},null,8,ae),[[C,r.value.name]])]),t("div",null,[t("label",ne,l(e.$t("modals.customSkills.descriptionLabel")),1),w(t("input",{"onUpdate:modelValue":o[2]||(o[2]=s=>r.value.description=s),type:"text",placeholder:e.$t("modals.customSkills.descriptionPlaceholder"),class:"w-full px-3 py-2 text-sm rounded-lg bg-[var(--bg-elevated)] text-[var(--text-primary)] border border-[var(--border-subtle)] outline-none focus:border-amber-500/50"},null,8,ie),[[C,r.value.description]])]),t("div",null,[t("label",re,l(e.$t("modals.customSkills.instructionsLabel")),1),w(t("textarea",{"onUpdate:modelValue":o[3]||(o[3]=s=>r.value.instructions=s),placeholder:e.$t("modals.customSkills.instructionsPlaceholder"),rows:"8",class:"w-full px-3 py-2 text-sm rounded-lg bg-[var(--bg-elevated)] text-[var(--text-primary)] border border-[var(--border-subtle)] outline-none focus:border-amber-500/50 resize-y min-h-[120px] max-h-[300px] font-mono"},null,8,de),[[C,r.value.instructions]])]),v.value?(n(),a("p",ce,l(v.value),1)):u("",!0),t("div",ue,[t("button",{onClick:T,class:"px-4 py-2 text-sm rounded-lg font-medium transition-all bg-white/10 text-zinc-300 hover:bg-white/20"},l(e.$t("common.cancel")),1),t("button",{onClick:A,disabled:k.value||!r.value.name.trim()||!r.value.instructions.trim(),class:"px-4 py-2 text-sm rounded-lg font-medium transition-all bg-amber-500/20 text-amber-400 hover:bg-amber-500/30 disabled:opacity-50 disabled:cursor-not-allowed"},l(k.value?e.$t("common.saving"):e.$t("common.save")),9,me)])])):(n(),a("div",ve,[z.value?(n(),a("div",pe,[t("p",be,l(e.$t("common.loading")),1)])):_.value.length===0?(n(),a("div",xe,[t("div",he,[g(y(q),{class:"w-8 h-8 text-amber-400/50"})]),t("p",fe,l(e.$t("modals.customSkills.noSkills")),1),t("p",ge,l(e.$t("modals.customSkills.noSkillsHint")),1)])):(n(),a("div",ye,[(n(!0),a(j,null,E(_.value,s=>(n(),a("div",{key:s.id,class:"bg-white/5 border border-white/5 rounded-xl p-4 hover:bg-white/[0.07] transition-colors"},[t("div",_e,[t("div",ke,[t("h3",$e,l(s.name),1),s.description?(n(),a("p",Se,l(s.description),1)):u("",!0)]),t("div",we,[t("button",{onClick:i=>U(s),class:"p-1.5 text-zinc-400 hover:text-amber-400 hover:bg-amber-500/20 rounded-lg transition-all",title:e.$t("modals.customSkills.editSkill")},[g(y(J),{class:"w-3.5 h-3.5"})],8,Ce),$.value!==s.id?(n(),a("button",{key:0,onClick:i=>$.value=s.id,class:"p-1.5 text-zinc-400 hover:text-red-400 hover:bg-red-500/20 rounded-lg transition-all",title:e.$t("common.delete")},[g(y(O),{class:"w-3.5 h-3.5"})],8,ze)):(n(),a("div",Fe,[t("button",{onClick:i=>H(s.id),class:"px-2 py-1 text-[10px] rounded-lg font-medium bg-red-500/20 text-red-400 hover:bg-red-500/30 transition-all"},l(e.$t("common.delete")),9,Ve),t("button",{onClick:o[4]||(o[4]=i=>$.value=null),class:"px-2 py-1 text-[10px] rounded-lg font-medium bg-white/10 text-zinc-300 hover:bg-white/20 transition-all"},l(e.$t("common.cancel")),1)]))])]),s.required_secrets&&s.required_secrets.length>0?(n(),a("div",Ke,[t("div",je,[g(y(W),{class:"w-3 h-3 text-zinc-500"}),t("span",Ee,l(e.$t("modals.customSkills.secrets")),1)]),t("p",Pe,l(e.$t("modals.customSkills.secretsHint")),1),t("div",qe,[(n(!0),a(j,null,E(s.required_secrets,i=>(n(),a("div",{key:i,class:"flex items-center gap-2"},[t("div",Le,[t("div",Be,[t("code",De,l(i),1),V(s.id,i)?(n(),a("span",Me,l(e.$t("modals.customSkills.secretConfigured")),1)):(n(),a("span",Ue,l(e.$t("modals.customSkills.secretNotConfigured")),1))])]),t("div",Te,[c.value===`${s.id}:${i}`?w((n(),a("input",{key:0,"onUpdate:modelValue":o[5]||(o[5]=x=>b.value=x),type:"password",placeholder:e.$t("modals.customSkills.secretPlaceholder"),class:"w-36 px-2 py-1 text-[11px] rounded-lg bg-[var(--bg-elevated)] text-[var(--text-primary)] border border-[var(--border-subtle)] outline-none focus:border-amber-500/50",onKeydown:[P(x=>K(s.id,i),["enter"]),o[6]||(o[6]=P(x=>c.value=null,["escape"]))]},null,40,Ae)),[[C,b.value]]):u("",!0),c.value===`${s.id}:${i}`?(n(),a("button",{key:1,onClick:x=>K(s.id,i),disabled:!b.value.trim()||S.value,class:"px-2 py-1 text-[10px] rounded-lg font-medium bg-amber-500/20 text-amber-400 hover:bg-amber-500/30 disabled:opacity-50 transition-all"},l(S.value?e.$t("modals.customSkills.secretSaved"):e.$t("modals.customSkills.secretSave")),9,He)):u("",!0),c.value!==`${s.id}:${i}`?(n(),a("button",{key:2,onClick:x=>B(s.id,i),class:"px-2 py-1 text-[10px] rounded-lg font-medium bg-white/10 text-zinc-300 hover:bg-white/20 transition-all"},l(V(s.id,i)?e.$t("modals.settings.apiKeyChange"):e.$t("modals.customSkills.secretSave")),9,Re)):u("",!0),V(s.id,i)&&c.value!==`${s.id}:${i}`?(n(),a("button",{key:3,onClick:x=>D(s.id,i),class:"px-2 py-1 text-[10px] rounded-lg font-medium text-zinc-500 hover:text-red-400 hover:bg-red-500/10 transition-all"},l(e.$t("modals.customSkills.secretRemove")),9,Xe)):u("",!0),c.value===`${s.id}:${i}`?(n(),a("button",{key:4,onClick:o[7]||(o[7]=x=>c.value=null),class:"px-2 py-1 text-[10px] rounded-lg font-medium bg-white/10 text-zinc-300 hover:bg-white/20 transition-all"},l(e.$t("common.cancel")),1)):u("",!0)])]))),128))])])):u("",!0)]))),128))]))]))])])]))}};export{Ne as default};
