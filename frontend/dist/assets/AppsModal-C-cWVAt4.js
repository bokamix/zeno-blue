import{z as j,r as f,o as z,e as r,i as a,l as o,L as l,u as n,A as h,F as E,j as F,p,B as x,C as N,D,E as g,K as L,n as B}from"./vue-core-jACk-pto.js";import{L as y,X as w,b as I,d as K,T as M,R as P}from"./index-CRj31xvb.js";import"./tiptap-N4ivBHz1.js";import"./markdown-B3lvOPUD.js";import"./highlight-BX1zPj8W.js";const S={class:"glass-solid rounded-3xl w-full max-w-lg max-h-[80vh] flex flex-col animate-modal-enter relative overflow-hidden"},V={class:"flex items-center justify-between p-6 border-b border-white/5"},O={class:"flex items-center gap-3"},R={class:"p-2 rounded-xl bg-gradient-to-br from-blue-500/20 to-purple-500/20"},G={class:"text-lg font-semibold text-[var(--text-primary)]"},H={class:"flex-1 overflow-y-auto p-6 custom-scroll"},J={key:0,class:"text-center py-12"},U={class:"w-16 h-16 rounded-2xl bg-gradient-to-br from-blue-500/10 to-purple-500/10 flex items-center justify-center mx-auto mb-4"},X={class:"text-zinc-400"},q={key:1,class:"space-y-3"},Q={class:"flex items-start justify-between"},W={class:"flex-1 min-w-0"},Y={class:"flex items-center gap-2"},Z={key:0,class:"flex items-center gap-2 flex-1"},ee=["onKeydown","placeholder"],te=["onClick","title"],se=["title"],oe={key:1,class:"font-medium text-[var(--text-primary)]"},re=["href"],ae={class:"flex items-center gap-2 ml-4 flex-shrink-0"},le=["onClick","title"],ne=["onClick","title"],ie=["onClick","title"],de=["onClick"],be={__name:"AppsModal",emits:["close"],setup(ce,{emit:ue}){const{t:k}=j(),b=f([]),i=f(null),c=f(""),u=f(null),m=async()=>{try{const e=await fetch("/apps");e.ok&&(b.value=await e.json())}catch(e){console.error("Failed to fetch apps",e)}},$=async e=>{const s=e.alive?"__stop":"__start";try{(await fetch(`/apps/${e.app_id}/${s}`,{method:"POST"})).ok&&await m()}catch(t){console.error("Failed to toggle app",t)}},C=async e=>{try{(await fetch(`/apps/${e.app_id}/__restart`,{method:"POST"})).ok&&await m()}catch(s){console.error("Failed to restart app",s)}},A=e=>{i.value=e.app_id,c.value=e.name,B(()=>{if(u.value){const s=Array.isArray(u.value)?u.value[0]:u.value;s?.focus(),s?.select()}})},v=()=>{i.value=null,c.value=""},_=async e=>{if(!c.value.trim()){v();return}try{(await fetch(`/apps/${e.app_id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:c.value.trim()})})).ok&&await m()}catch(s){console.error("Failed to rename app",s)}v()},T=async e=>{if(confirm(k("modals.apps.confirmDelete",{name:e.name})))try{(await fetch(`/apps/${e.app_id}`,{method:"DELETE"})).ok&&await m()}catch(s){console.error("Failed to delete app",s)}};return z(()=>{m()}),(e,s)=>(a(),r("div",{class:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:s[2]||(s[2]=L(t=>e.$emit("close"),["self"]))},[o("div",S,[s[3]||(s[3]=o("div",{class:"absolute top-0 left-8 right-8 h-px bg-gradient-to-r from-transparent via-blue-500/50 to-transparent"},null,-1)),o("div",V,[o("div",O,[o("div",R,[l(n(y),{class:"w-5 h-5 text-blue-400"})]),o("h2",G,h(e.$t("modals.apps.title")),1)]),o("button",{onClick:s[0]||(s[0]=t=>e.$emit("close")),class:"p-2 rounded-xl text-[var(--text-muted)] hover:text-[var(--text-primary)] hover:bg-[var(--bg-surface)] transition-all"},[l(n(w),{class:"w-5 h-5"})])]),o("div",H,[b.value.length===0?(a(),r("div",J,[o("div",U,[l(n(y),{class:"w-8 h-8 text-blue-400/50"})]),o("p",X,h(e.$t("modals.apps.noApps")),1)])):(a(),r("div",q,[(a(!0),r(E,null,F(b.value,t=>(a(),r("div",{key:t.app_id,class:"bg-white/5 border border-white/5 rounded-xl p-4 hover:bg-white/[0.07] transition-colors"},[o("div",Q,[o("div",W,[o("div",Y,[o("span",{class:x(["w-2.5 h-2.5 rounded-full flex-shrink-0",t.alive?"bg-emerald-500 shadow-lg shadow-emerald-500/50":"bg-zinc-500"])},null,2),i.value===t.app_id?(a(),r("div",Z,[N(o("input",{ref_for:!0,ref_key:"editInput",ref:u,"onUpdate:modelValue":s[1]||(s[1]=d=>c.value=d),onKeydown:[g(d=>_(t),["enter"]),g(v,["escape"])],class:"flex-1 px-2 py-1 bg-[var(--bg-surface)] border border-[var(--border-subtle)] rounded-lg text-[var(--text-primary)] text-sm focus:outline-none focus:border-blue-500",placeholder:e.$t("modals.apps.enterName")},null,40,ee),[[D,c.value]]),o("button",{onClick:d=>_(t),class:"p-1.5 text-emerald-400 hover:text-emerald-300 hover:bg-emerald-500/20 rounded-lg transition-all",title:e.$t("common.save")},[l(n(I),{class:"w-4 h-4"})],8,te),o("button",{onClick:v,class:"p-1.5 text-zinc-400 hover:text-zinc-300 hover:bg-white/10 rounded-lg transition-all",title:e.$t("common.cancel")},[l(n(w),{class:"w-4 h-4"})],8,se)])):(a(),r("span",oe,h(t.name),1))]),t.url&&t.alive?(a(),r("a",{key:0,href:t.url,target:"_blank",class:"text-sm text-blue-400 hover:text-blue-300 mt-1 block truncate transition-colors"},h(t.url),9,re)):p("",!0)]),o("div",ae,[i.value!==t.app_id?(a(),r("button",{key:0,onClick:d=>A(t),class:"p-2 text-[var(--text-secondary)] hover:text-[var(--text-primary)] hover:bg-white/10 rounded-lg transition-all",title:e.$t("modals.apps.rename")},[l(n(K),{class:"w-4 h-4"})],8,le)):p("",!0),i.value!==t.app_id?(a(),r("button",{key:1,onClick:d=>T(t),class:"p-2 text-[var(--text-secondary)] hover:text-red-400 hover:bg-red-500/20 rounded-lg transition-all",title:e.$t("common.delete")},[l(n(M),{class:"w-4 h-4"})],8,ne)):p("",!0),t.alive&&i.value!==t.app_id?(a(),r("button",{key:2,onClick:d=>C(t),class:"p-2 text-[var(--text-secondary)] hover:text-[var(--text-primary)] hover:bg-white/10 rounded-lg transition-all",title:e.$t("common.restart")},[l(n(P),{class:"w-4 h-4"})],8,ie)):p("",!0),i.value!==t.app_id?(a(),r("button",{key:3,onClick:d=>$(t),class:x(["px-4 py-2 text-sm rounded-lg font-medium transition-all",t.alive?"bg-red-500/20 text-red-400 hover:bg-red-500/30 border border-red-500/20":"bg-emerald-500/20 text-emerald-400 hover:bg-emerald-500/30 border border-emerald-500/20"])},h(t.alive?e.$t("common.stop"):e.$t("common.start")),11,de)):p("",!0)])])]))),128))]))])])]))}};export{be as default};
