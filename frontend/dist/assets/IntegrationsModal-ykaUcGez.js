import{z as y,r as k,o as $,x as S,e as a,i,l as t,L as m,u as h,A as n,p as c,F as p,j as g,K as z}from"./vue-core-jACk-pto.js";import{P as _,X as C}from"./index-D8OFS6iA.js";import"./tiptap-N4ivBHz1.js";import"./markdown-B3lvOPUD.js";import"./highlight-BX1zPj8W.js";const E={class:"glass-solid rounded-3xl w-full max-w-lg max-h-[80vh] flex flex-col animate-modal-enter relative overflow-hidden"},I={class:"flex items-center justify-between p-6 border-b border-white/5"},j={class:"flex items-center gap-3"},L={class:"p-2 rounded-xl bg-gradient-to-br from-sky-500/20 to-purple-500/20"},N={class:"text-lg font-semibold text-[var(--text-primary)]"},O={class:"flex-1 overflow-y-auto p-6 space-y-6 custom-scroll"},A={key:0},F={class:"text-xs font-semibold text-zinc-500 uppercase tracking-wider mb-3"},P={class:"space-y-2"},V={class:"flex items-center gap-3"},B={class:"w-10 h-10 rounded-xl bg-gradient-to-br from-emerald-500/20 to-green-500/20 flex items-center justify-center"},D={class:"text-emerald-400 font-semibold"},M={class:"text-sm font-medium text-[var(--text-primary)]"},U={key:0,class:"text-xs text-zinc-500"},J=["onClick"],K={key:1},T={class:"text-xs font-semibold text-zinc-500 uppercase tracking-wider mb-3"},X={class:"space-y-2"},q={class:"flex items-center gap-3"},G={class:"w-10 h-10 rounded-xl bg-white/5 flex items-center justify-center"},H={class:"text-zinc-400 font-semibold"},Q={class:"text-sm font-medium text-zinc-300"},R=["onClick"],W={key:2,class:"text-center py-12"},Y={class:"w-16 h-16 rounded-2xl bg-gradient-to-br from-sky-500/10 to-purple-500/10 flex items-center justify-center mx-auto mb-4"},Z={class:"text-zinc-400"},ee={class:"text-sm text-zinc-600 mt-1"},le={__name:"IntegrationsModal",emits:["close"],setup(te,{emit:oe}){const{t:f}=y(),r=k({connected:[],available:[]}),d=async()=>{try{const e=await fetch("/integrations");e.ok&&(r.value=await e.json())}catch(e){console.error("Failed to fetch integrations",e)}},x=e=>{window.open(`/oauth/connect/${e}`,"oauth","width=500,height=600,popup=1")},v=async e=>{if(confirm(f("confirmations.disconnectProvider",{provider:e})))try{await fetch(`/oauth/disconnect/${e}`,{method:"DELETE"}),await d()}catch(o){console.error("Failed to disconnect integration",o)}},l=e=>{e.data?.type==="oauth_complete"&&d()},u=e=>{if(e.key==="oauth_complete")try{const o=JSON.parse(e.newValue);o?.type==="oauth_complete"&&(localStorage.removeItem("oauth_complete"),l({data:o}))}catch(o){console.error("Error parsing oauth_complete from localStorage:",o)}},b=()=>{try{const e=localStorage.getItem("oauth_complete");if(e){const o=JSON.parse(e);o?.type==="oauth_complete"&&o.timestamp&&Date.now()-o.timestamp<3e4?(localStorage.removeItem("oauth_complete"),l({data:o})):localStorage.removeItem("oauth_complete")}}catch{localStorage.removeItem("oauth_complete")}};return $(()=>{d(),window.addEventListener("message",l),window.addEventListener("storage",u),b()}),S(()=>{window.removeEventListener("message",l),window.removeEventListener("storage",u)}),(e,o)=>(i(),a("div",{class:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:o[1]||(o[1]=z(s=>e.$emit("close"),["self"]))},[t("div",E,[o[2]||(o[2]=t("div",{class:"absolute top-0 left-8 right-8 h-px bg-gradient-to-r from-transparent via-sky-500/50 to-transparent"},null,-1)),t("div",I,[t("div",j,[t("div",L,[m(h(_),{class:"w-5 h-5 text-sky-400"})]),t("h2",N,n(e.$t("modals.integrations.title")),1)]),t("button",{onClick:o[0]||(o[0]=s=>e.$emit("close")),class:"p-2 rounded-xl text-[var(--text-muted)] hover:text-[var(--text-primary)] hover:bg-[var(--bg-surface)] transition-all"},[m(h(C),{class:"w-5 h-5"})])]),t("div",O,[r.value.connected?.length>0?(i(),a("div",A,[t("h3",F,n(e.$t("modals.integrations.connected")),1),t("div",P,[(i(!0),a(p,null,g(r.value.connected,s=>(i(),a("div",{key:s.provider,class:"flex items-center justify-between bg-white/5 border border-white/5 rounded-xl p-4 hover:bg-white/[0.07] transition-colors"},[t("div",V,[t("div",B,[t("span",D,n(s.display_name?.[0]||s.provider[0].toUpperCase()),1)]),t("div",null,[t("p",M,n(s.display_name||s.provider),1),s.account_email?(i(),a("p",U,n(s.account_email),1)):c("",!0)])]),t("button",{onClick:w=>v(s.provider),class:"text-xs text-zinc-500 hover:text-red-400 px-3 py-1.5 hover:bg-red-500/10 rounded-lg transition-all"},n(e.$t("common.disconnect")),9,J)]))),128))])])):c("",!0),r.value.available?.length>0?(i(),a("div",K,[t("h3",T,n(e.$t("modals.integrations.available")),1),t("div",X,[(i(!0),a(p,null,g(r.value.available,s=>(i(),a("div",{key:s.name,class:"flex items-center justify-between bg-white/5 border border-white/5 rounded-xl p-4 hover:bg-white/[0.07] transition-colors"},[t("div",q,[t("div",G,[t("span",H,n(s.display_name?.[0]||s.name[0].toUpperCase()),1)]),t("p",Q,n(s.display_name||s.name),1)]),t("button",{onClick:w=>x(s.name),class:"text-xs bg-gradient-to-r from-blue-600 to-sky-600 text-white px-4 py-2 rounded-lg shadow-lg shadow-blue-500/20 hover:shadow-blue-500/30 hover:scale-105 transition-all"},n(e.$t("common.connect")),9,R)]))),128))])])):c("",!0),!r.value.connected?.length&&!r.value.available?.length?(i(),a("div",W,[t("div",Y,[m(h(_),{class:"w-8 h-8 text-sky-400/50"})]),t("p",Z,n(e.$t("modals.integrations.noIntegrations")),1),t("p",ee,n(e.$t("modals.integrations.configureOAuth")),1)])):c("",!0)])])]))}};export{le as default};
