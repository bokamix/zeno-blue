import{r as g,u as k}from"./xlsx-viewer-uZelXSz_.js";import{r as u,o as w,e,i as t,p as h,l as o,F as v,j as x,I as m,A as d}from"./vue-core-Chol9MOc.js";const S={class:"excel-viewer"},B={key:0,class:"flex items-center justify-center h-64"},C={key:1,class:"flex flex-col h-full"},F={key:0,class:"flex gap-1 mb-3 border-b border-[var(--border-subtle)] pb-2"},j=["onClick"],E={class:"overflow-x-auto flex-1"},N={class:"min-w-full text-sm border-collapse"},V={class:"text-xs text-[var(--text-muted)] mt-2"},q={key:2,class:"text-red-400 p-4"},D={__name:"ExcelViewer",props:{url:{type:String,required:!0}},setup(y){const b=y,p=u(!0),s=u([]),l=u(0),i=u(null);return w(async()=>{try{const c=await(await fetch(b.url)).arrayBuffer(),r=g(c,{type:"array"});s.value=r.SheetNames.map(a=>({name:a,data:k.sheet_to_json(r.Sheets[a],{header:1})}))}catch(n){console.error("Failed to load Excel:",n),i.value="Failed to parse spreadsheet: "+n.message}finally{p.value=!1}}),(n,c)=>(t(),e("div",S,[p.value?(t(),e("div",B,[...c[0]||(c[0]=[o("span",{class:"text-[var(--text-muted)]"},"Parsing spreadsheet...",-1)])])):s.value.length>0?(t(),e("div",C,[s.value.length>1?(t(),e("div",F,[(t(!0),e(v,null,x(s.value,(r,a)=>(t(),e("button",{key:r.name,onClick:f=>l.value=a,class:m(["px-3 py-1.5 text-sm rounded-t transition-colors",l.value===a?"bg-[var(--bg-elevated)] text-[var(--text-primary)]":"text-[var(--text-muted)] hover:text-[var(--text-secondary)] hover:bg-[var(--bg-surface)]"])},d(r.name),11,j))),128))])):h("",!0),o("div",E,[o("table",N,[o("tbody",null,[(t(!0),e(v,null,x(s.value[l.value]?.data||[],(r,a)=>(t(),e("tr",{key:a,class:m(a===0?"bg-[var(--bg-surface)]":"hover:bg-[var(--bg-surface)]/50")},[(t(!0),e(v,null,x(r,(f,_)=>(t(),e("td",{key:_,class:m(["px-3 py-2 border border-[var(--border-subtle)] text-[var(--text-secondary)]",a===0?"font-medium text-[var(--text-primary)]":""])},d(f??""),3))),128))],2))),128))])])]),o("div",V,d(s.value[l.value]?.data?.length||0)+" rows ",1)])):i.value?(t(),e("div",q,d(i.value),1)):h("",!0)]))}};export{D as default};
